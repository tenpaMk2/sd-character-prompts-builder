---
import Layout from "../layouts/Layout.astro";
import CategoryArea from "../components/CategoryArea.astro";
import { tabNames, type TabKey } from "../components/Tabs.astro";
import { allCategories, type Category } from "../libs/prompts-store";
import OutputArea from "../components/OutputArea.astro";
import Modal from "../components/Modal.astro";

const tabKey: TabKey = `main`;
const tabName = tabNames[tabKey];
const layoutInfo = {
  tabKey,
  tabName,
};

const names: { [K in Category]: string } = {
  "eyes-color": `ç›®ã®è‰²`,
  "eyes-shape": `ç›®ã®å½¢çŠ¶`,
  "eyebrows-shape": `çœ‰æ¯›`,
  eyelashes: `ç«æ¯›`,
  "hair-color": `é«ªè‰²`,
  "hair-length": `é«ªã®é•·ã•`,
  "hair-style": `é«ªå‹`,
  "tied-hair": `é«ªã®çµã³æ–¹`,
  "front-hair": `å‰é«ª`,
  sidelocks: `æ¨ªé«ª`,
  "top-of-the-head": `é ­é ‚`,
  "hair-misc": `é«ª: ãã®ä»–`,
  "hair-ornament": `é«ªé£¾ã‚Š`,
  "hair-bow": `é«ª: ğŸ€`,
  "hair-ribbon": `é«ª: ğŸ—`,
  hairband: `é«ª: ãƒ˜ã‚¢ãƒãƒ³ãƒ‰`,
  misc: `ãã®ä»–`,
  breasts: `èƒ¸ã®å¤§ãã•`,
} as const;
---

<Layout {...layoutInfo}>
  <before-unload-script data-prod={import.meta.env.PROD} style="display:none"
  ></before-unload-script>
  {
    allCategories.map((category) => (
      <CategoryArea name={names[category]} category={category} />
    ))
  }
  <OutputArea />
  <Modal />
</Layout>

<script>
  // Enable scripts only production mode.
  class BeforeUnloadScript extends HTMLElement {
    constructor() {
      super();

      const isProduction = this.dataset.prod === ``;
      if (isProduction) {
        window.addEventListener(`beforeunload`, (event: BeforeUnloadEvent) => {
          event.preventDefault();
          event.returnValue = ``;
        });
      }
    }
  }

  customElements.define(`before-unload-script`, BeforeUnloadScript);
</script>
